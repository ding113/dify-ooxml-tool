identity:
  name: extract_ooxml_text
  author: ding113
  label:
    en_US: "Extract OOXML Text for Translation"
    zh_Hans: "提取OOXML文本用于翻译"
description:
  human:
    en_US: "Parse DOCX/XLSX/PPTX files and extract all translatable text with position tracking"
    zh_Hans: "解析DOCX/XLSX/PPTX文件并提取所有可翻译文本及位置信息"
  llm: "Extract all translatable text from OOXML documents (DOCX, XLSX, PPTX) while preserving exact XML locations for format-preserving translation reconstruction"
parameters:
  - name: input_file
    type: file
    required: true
    label:
      en_US: "OOXML Document File"
      zh_Hans: "OOXML文档文件"
    human_description:
      en_US: "Upload a DOCX, XLSX, or PPTX file for text extraction and translation processing"
      zh_Hans: "上传DOCX、XLSX或PPTX文件进行文本提取和翻译处理"
    llm_description: "Upload a DOCX, XLSX, or PPTX file for text extraction. Supports Microsoft Office document formats including Word documents (.docx), Excel spreadsheets (.xlsx), and PowerPoint presentations (.pptx)"
    form: llm
  - name: file_id
    type: string
    required: true
    label:
      en_US: "File Processing ID"
      zh_Hans: "文件处理ID"
    human_description:
      en_US: "Unique identifier for this document processing session"
      zh_Hans: "此文档处理会话的唯一标识符"
    llm_description: "Unique identifier for this document processing session, used to track state across workflow nodes"
    form: llm
  - name: text_unit_level
    type: select
    required: false
    default: "element"
    form: form
    label:
      en_US: "Text Unit Level"
      zh_Hans: "文本单元级别"
    human_description:
      en_US: "Choose text extraction granularity: 'element' extracts individual w:t elements (default, most precise), 'run' extracts w:r runs (reduces fragmentation), 'paragraph' extracts w:p paragraphs (highest coherence)"
      zh_Hans: "选择文本提取粒度：'element'提取单个w:t元素（默认，最精确），'run'提取w:r运行（减少碎片化），'paragraph'提取w:p段落（最高连贯性）"
    llm_description: "Text extraction granularity level. 'element' (default) extracts each w:t text element individually for maximum precision. 'run' extracts entire w:r run elements, combining multiple w:t elements with same formatting to reduce translation fragmentation issues like '12A层' being split into separate parts. 'paragraph' extracts entire w:p paragraph elements for maximum semantic coherence."
    placeholder:
      en_US: "Select text unit level"
      zh_Hans: "选择文本单元级别"
    options:
      - value: "element"
        label:
          en_US: "Element Level (w:t, Default)"
          zh_Hans: "元素级别（w:t，默认）"
      - value: "run"
        label:
          en_US: "Run Level (w:r)"
          zh_Hans: "运行级别（w:r）"
      - value: "paragraph"
        label:
          en_US: "Paragraph Level (w:p)"
          zh_Hans: "段落级别（w:p）"
extra:
  python:
    source: tools/extract_ooxml_text.py
output_schema:
  type: object
  properties:
    success:
      type: boolean
      description: "Whether extraction was successful"
    file_id:
      type: string
      description: "The file processing identifier"
    file_type:
      type: string
      enum: ["docx", "xlsx", "pptx"]
      description: "Detected OOXML file type"
    extracted_text_count:
      type: integer
      description: "Number of extractable text segments found"
    file_size_mb:
      type: number
      description: "Original file size in MB"
    supported_elements:
      type: array
      items:
        type: string
      description: "List of XML element types found (w:t, si, a:t, etc.)"
    message:
      type: string
      description: "Status message or error details"